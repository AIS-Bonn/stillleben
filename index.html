<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>stillleben | stillleben Python</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">stillleben <span class="m-thin">Python</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-12 m-col-m-none">
            <li><a href="installation.html">Installation</a></li>
            <li><a href="examples.html">Examples</a></li>
            <li><a href="modules.html">Modules</a></li>
            <li><a href="classes.html">Classes</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="5">
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          stillleben
        </h1>
<figure>
<img alt="YCB-Video example" src="ycb.jpeg" style="width: 100%" />
</figure>
<section id="what-can-it-do-for-me">
<h2>What can it do for me?</h2>
<p>Stillleben generates realistic arrangements of rigid bodies and provides
various outputs that can be used to train deep learning models:</p>
<ul>
<li>A rendered RGB image of the scene. Depending on the rendering settings, this
rendering can be of quite high quality, in some cases photorealistic.
The image can be imbued with noise using the <a class="m-doc" href="stillleben.camera_model.html">stillleben.camera_model</a>
module.</li>
<li>A depth image.</li>
<li>Class-wise and instance-wise semantic segmentation of the scene.</li>
<li>Camera- and object-space coordinates, highly useful for training
methods that exploit pixel-wise correspondence.</li>
<li>Camera-space normals.</li>
</ul>
<p>Stillleben is highly integrated with the <a href="https://pytorch.org">PyTorch</a>
deep learning framework. It can be used to produce training data on-line to
save dataset generation time or to train methods that require interaction with
the scene.</p>
<p>For scene registration and other applications we provide an approximative
differentiation module in <a class="m-doc" href="stillleben.diff.html">stillleben.diff</a> which allows backpropagation
of image-space gradients to object poses and shapes.</p>
<p>This page documents the Python API of stillleben. The Python API is a wrapper
around the C++ core implementation.</p>
</section>
<section id="getting-started">
<h2>Getting started</h2>
<p>If you haven't already, go through the <a class="m-doc" href="installation.html">installation instructions</a>.</p>
<p>Here is a short API example:</p>
<pre class="m-code"><span class="kn">import</span> <span class="nn">stillleben</span> <span class="k">as</span> <span class="nn">sl</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="k">def</span> <span class="nf">view_mesh</span><span class="p">(</span><span class="n">mesh_filenames</span><span class="p">,</span> <span class="n">ibl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">serialize</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># Load meshes</span>
    <span class="n">meshes</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">Mesh</span><span class="o">.</span><span class="n">load_threaded</span><span class="p">(</span><span class="n">mesh_filenames</span><span class="p">)</span>

    <span class="c1"># Meshes can come in strange dimensions - rescale to something reasonable</span>
    <span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">meshes</span><span class="p">:</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">center_bbox</span><span class="p">()</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">scale_to_bbox_diagonal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Dump some object statistics</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object properties:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - mass: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">mass</span><span class="si">}</span><span class="s2"> kg&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - density: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">density</span><span class="si">}</span><span class="s2"> kg/m^3&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - volume: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2"> m^3&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - inertial frame:</span><span class="se">\n</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">inertial_frame</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - inertia in inertial frame: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">inertia</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create a scene with a few of the objects</span>
    <span class="n">scene</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">Scene</span><span class="p">((</span><span class="mi">1920</span><span class="p">,</span><span class="mi">1080</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">meshes</span><span class="p">))</span>
        <span class="n">scene</span><span class="o">.</span><span class="n">add_object</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="c1"># Let them fall in a heap</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">simulate_tabletop_scene</span><span class="p">()</span>

    <span class="c1"># Setup lighting</span>
    <span class="k">if</span> <span class="n">ibl</span><span class="p">:</span>
        <span class="n">scene</span><span class="o">.</span><span class="n">light_map</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">LightMap</span><span class="p">(</span><span class="n">ibl</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scene</span><span class="o">.</span><span class="n">choose_random_light_direction</span><span class="p">()</span>
        <span class="n">scene</span><span class="o">.</span><span class="n">ambient_light</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>

    <span class="c1"># Display a plane &amp; set background color</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">background_plane_size</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">background_color</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

    <span class="c1"># Render a frame</span>
    <span class="n">renderer</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">RenderPass</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">serialize</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Serialized scene:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">scene</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>

    <span class="c1"># Display interactive viewer</span>
    <span class="n">sl</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">view_scene</span><span class="p">(</span><span class="n">scene_filename</span><span class="p">):</span>
    <span class="n">scene</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">Scene</span><span class="p">((</span><span class="mi">1280</span><span class="p">,</span> <span class="mi">800</span><span class="p">))</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">scene_filename</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">sl</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">argparse</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Stillleben mesh viewer.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;meshes&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;PATH&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The mesh file(s) to load&#39;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">SL_PATH</span> <span class="o">/</span> <span class="s1">&#39;tests&#39;</span> <span class="o">/</span> <span class="s1">&#39;stanford_bunny&#39;</span> <span class="o">/</span> <span class="s1">&#39;scene.gltf&#39;</span><span class="p">))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ibl&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;PATH&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;IBL light map to load&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--serialize&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Show serialized scene&#39;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">sl</span><span class="o">.</span><span class="n">init</span><span class="p">()</span> <span class="c1"># use sl.init_cuda() for CUDA interop</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">meshes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.scene&#39;</span><span class="p">)):</span>
        <span class="n">view_scene</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">view_mesh</span><span class="p">(</span><span class="n">mesh_filenames</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">meshes</span><span class="p">,</span> <span class="n">ibl</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ibl</span><span class="p">,</span> <span class="n">serialize</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">serialize</span><span class="p">)</span></pre>
</section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for modules, classes, functions and other
            symbols. You can omit any prefix from the symbol path; adding a <code>.</code>
            suffix lists all members of given symbol.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>stillleben Python. Created with <a href="https://mcss.mosra.cz/documentation/python/">m.css Python doc generator</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
